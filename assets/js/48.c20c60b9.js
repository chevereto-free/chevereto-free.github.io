(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{494:function(t,a,e){"use strict";e.r(a);var s=e(68),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"server-requirements"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#server-requirements"}},[t._v("#")]),t._v(" Server Requirements")]),t._v(" "),e("h2",{attrs:{id:"php"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#php"}},[t._v("#")]),t._v(" PHP")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Version")]),t._v(" "),e("th",[t._v("PHP")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("3.20")]),t._v(" "),e("td",[t._v("7.4")])])])]),t._v(" "),e("p",[t._v("Chevereto-Free is "),e("a",{attrs:{href:"https://php.net/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PHP"),e("OutboundLink")],1),t._v(" software, it has been designed using:")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://deb.sury.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PHP packages"),e("OutboundLink")],1),t._v(" from Ondřej Surý.")]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.php.net/manual/en/extensions.membership.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("PHP extensions"),e("OutboundLink")],1),t._v(" provided by "),e("a",{attrs:{href:"https://pecl.php.net/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PECL"),e("OutboundLink")],1),t._v(".")])]),t._v(" "),e("p",[t._v("Packages and PECL provides the same convenience, but as packages are made for debian-based systems you should prefer PECL if you don't have a compatible system.")]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("Packages vs PECL")]),t._v(" "),e("p",[t._v("Packages not only contain the software, it could trigger other effects in the system.")])]),t._v(" "),e("h3",{attrs:{id:"php-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#php-configuration"}},[t._v("#")]),t._v(" PHP configuration")]),t._v(" "),e("p",[t._v("The following "),e("code",[t._v("ini")]),t._v(" values are recommended for Chevereto installations.")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[t._v("upload_max_filesize "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 50M"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\npost_max_size "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 50M"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmax_execution_time "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmemory_limit "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 512M"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("table",[e("thead",[e("tr",[e("th",[t._v("Property")]),t._v(" "),e("th",[t._v("Description")]),t._v(" "),e("th",[t._v("Example")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("upload_max_filesize")]),t._v(" "),e("td",[t._v("Maximum upload size")]),t._v(" "),e("td",[e("code",[t._v("50M")]),t._v(" for 50 MB")])]),t._v(" "),e("tr",[e("td",[t._v("post_max_size")]),t._v(" "),e("td",[t._v("Maximum post size")]),t._v(" "),e("td",[t._v("Same as above")])]),t._v(" "),e("tr",[e("td",[t._v("max_execution_time")]),t._v(" "),e("td",[t._v("Maximum time to execute the software, in seconds")]),t._v(" "),e("td",[e("code",[t._v("30")]),t._v(" for 30 seconds")])]),t._v(" "),e("tr",[e("td",[t._v("memory_limit")]),t._v(" "),e("td",[t._v("Maximum memory to allocate")]),t._v(" "),e("td",[e("code",[t._v("512M")]),t._v(" for 512 MB")])])])]),t._v(" "),e("p",[t._v("You can toggle this limits to reflect your hardware and server load. Check this article for more info: "),e("a",{attrs:{href:"http://www.php.net/manual/en/features.file-upload.common-pitfalls.php",target:"_blank",rel:"noopener noreferrer"}},[t._v("PHP common pitfalls"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"php-extensions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#php-extensions"}},[t._v("#")]),t._v(" PHP Extensions")]),t._v(" "),e("p",[t._v("The following PHP extensions are required for Chevereto.")]),t._v(" "),e("ul",[e("li",[t._v("curl")]),t._v(" "),e("li",[t._v("exif")]),t._v(" "),e("li",[t._v("fileinfo")]),t._v(" "),e("li",[t._v("hash")]),t._v(" "),e("li",[t._v("imagick")]),t._v(" "),e("li",[t._v("gd")]),t._v(" "),e("li",[t._v("json")]),t._v(" "),e("li",[t._v("mbstring")]),t._v(" "),e("li",[t._v("pdo")]),t._v(" "),e("li",[t._v("pdo-mysql")]),t._v(" "),e("li",[t._v("session")]),t._v(" "),e("li",[t._v("xml")]),t._v(" "),e("li",[t._v("zip")])]),t._v(" "),e("h3",{attrs:{id:"php-features"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#php-features"}},[t._v("#")]),t._v(" PHP Features")]),t._v(" "),e("p",[t._v("Chevereto requires unrestricted access to all PHP functions. If any PHP function is removed it could cause Chevereto to fail or to not work at all. Note that the following functions must not be restricted:")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://www.php.net/set-time-limit",target:"_blank",rel:"noopener noreferrer"}},[t._v("set_time_limit"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"image-library"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#image-library"}},[t._v("#")]),t._v(" Image library")]),t._v(" "),e("p",[t._v("The image library (GD, Imagick) should be provided with support for "),e("code",[t._v("PNG GIF JPG BMP WEBP")]),t._v(". By default, Chevereto uses Imagick and fallback to GD.")]),t._v(" "),e("p",[t._v("If you need to explicit use GD you can add this key to "),e("RouterLink",{attrs:{to:"/setup/server/settings-file.html"}},[t._v("Settings file")]),t._v(":")],1),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$settings")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'image_library'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'gd'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("div",{staticClass:"custom-block danger"},[e("p",{staticClass:"custom-block-title"},[t._v("Workaround missing formats")]),t._v(" "),e("p",[t._v("If the server doesn't provide support for all the image formats handled by Chevereto you must use the following "),e("RouterLink",{attrs:{to:"/setup/server/settings-file.html"}},[t._v("Settings file")]),t._v(" workaround.")],1),t._v(" "),e("p",[t._v("In the following example Chevereto is configured with explicit support only for PNG, GIF, BMP and JPG (removes WEBP):")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$settings")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'image_formats_available'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'PNG'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'GIF'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'BMP'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'JPG'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),e("h2",{attrs:{id:"configuring-image-library"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuring-image-library"}},[t._v("#")]),t._v(" Configuring image library")]),t._v(" "),e("p",[t._v("Check for "),e("RouterLink",{attrs:{to:"/setup/server/environment.html#image-handling-variables"}},[t._v("CHEVERETO_IMAGE_LIBRARY")]),t._v(" for changing the default image library used by Chevereto.")],1),t._v(" "),e("h3",{attrs:{id:"imagemagick"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#imagemagick"}},[t._v("#")]),t._v(" ImageMagick")]),t._v(" "),e("p",[t._v("Additional recommended ImageMagick configuration at "),e("code",[t._v("/etc/ImageMagick-6/policy.xml")]),t._v(" file:")]),t._v(" "),e("div",{staticClass:"language-xml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-xml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("policymap")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- policies --\x3e")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("policy")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("domain")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("resource"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("width"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("16KP"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("policy")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("domain")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("resource"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("height"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),e("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[e("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("16KP"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("policymap")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),e("h3",{attrs:{id:"filesystem"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#filesystem"}},[t._v("#")]),t._v(" Filesystem")]),t._v(" "),e("p",[t._v("User running "),e("code",[t._v("php")]),t._v(" must be in the owner group of your installation directory. This is required to allow Chevereto to modify the filesystem for uploading, one-click update and many other features.")]),t._v(" "),e("p",[t._v("Chevereto user will require "),e("strong",[t._v("read/write")]),t._v(" access in the following paths:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("/tmp")])]),t._v(" "),e("li",[e("code",[t._v("app/content/")])]),t._v(" "),e("li",[e("code",[t._v("app/content/languages/")])]),t._v(" "),e("li",[e("code",[t._v("app/content/languages/cache/")])]),t._v(" "),e("li",[e("code",[t._v("app/content/system/")])]),t._v(" "),e("li",[e("code",[t._v("content/")])]),t._v(" "),e("li",[e("code",[t._v("images/")])])]),t._v(" "),e("h2",{attrs:{id:"database"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#database"}},[t._v("#")]),t._v(" Database")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Version")]),t._v(" "),e("th",[t._v("MySQL")]),t._v(" "),e("th",[t._v("MariaDB")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("3.20")]),t._v(" "),e("td",[t._v("5.7, 8")]),t._v(" "),e("td",[t._v("10")])])])]),t._v(" "),e("ul",[e("li",[t._v("Database user must have "),e("code",[t._v("ALL PRIVILEGES")]),t._v(" over the target database")]),t._v(" "),e("li",[t._v("InnoDB table storage engine")])]),t._v(" "),e("div",{staticClass:"custom-block danger"},[e("p",{staticClass:"custom-block-title"},[t._v("Upgrading from old installation")]),t._v(" "),e("p",[t._v("Old versions using MyISAM table storage engine will require to convert the old tables to InnoDB. Read "),e("a",{attrs:{href:"https://dev.mysql.com/doc/refman/8.0/en/converting-tables-to-innodb.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Convert MyISAM tables to InnoDB"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"web-server-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#web-server-configuration"}},[t._v("#")]),t._v(" Web server configuration")]),t._v(" "),e("h3",{attrs:{id:"apache-http-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#apache-http-server"}},[t._v("#")]),t._v(" Apache HTTP server")]),t._v(" "),e("p",[t._v("Make sure that "),e("a",{attrs:{href:"https://httpd.apache.org/docs/current/mod/mod_rewrite.html",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("mod_rewrite")]),e("OutboundLink")],1),t._v(" is enabled and that your virtual host settings allows to perform URL rewriting:")]),t._v(" "),e("div",{staticClass:"language-apacheconf extra-class"},[e("pre",{pre:!0,attrs:{class:"language-apacheconf"}},[e("code",[t._v("    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Directory")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" /var/www/html")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Options")]),t._v(" -Indexes +FollowSymLinks +MultiViews\n        "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("AllowOverride")]),t._v(" All\n        "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Require")]),t._v(" all granted\n    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("Directory")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),e("p",[t._v("Apache configuration "),e("code",[t._v(".htaccess")]),t._v(" files are already included in the software.")]),t._v(" "),e("h4",{attrs:{id:"restrict-direct-access-to-php-files"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#restrict-direct-access-to-php-files"}},[t._v("#")]),t._v(" Restrict direct access to PHP files")]),t._v(" "),e("p",[t._v("Edit the "),e("a",{attrs:{href:"https://httpd.apache.org/docs/2.4/vhosts/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Virtual Host"),e("OutboundLink")],1),t._v(" entry by adding the following directive for your upload directory. This will disable PHP interpreter on folders containing public upload content:")]),t._v(" "),e("blockquote",[e("p",[t._v("Must edit "),e("code",[t._v("/var/www/html/images")]),t._v(" to reflect your actual upload directory.")])]),t._v(" "),e("div",{staticClass:"language-apacheconf extra-class"},[e("pre",{pre:!0,attrs:{class:"language-apacheconf"}},[e("code",[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Directory")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" /var/www/html/images")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("AllowOverride")]),t._v(" None\n    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("FilesMatch")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(' "\\.(?'),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v('[Pp][Hh][Pp][345]?|[Pp][Hh][Tt][Mm][Ll])|(po|sql|html?)$"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" !mod_authz_core.c")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Order")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Allow")]),t._v(",Deny\n            "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Deny")]),t._v(" from all\n        "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" mod_authz_core.c")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Require")]),t._v(" all denied\n        "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("FilesMatch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" mod_php7.c")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        php_flag engine off\n    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("FilesMatch")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('".+\\.*$"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("SetHandler")]),t._v(" !\n    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("FilesMatch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" mod_rewrite.c")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("RewriteRule")]),e("span",{pre:!0,attrs:{class:"token regex"}},[t._v(" ^.*\\.php$")]),t._v(" - "),e("span",{pre:!0,attrs:{class:"token directive-flags keyword"}},[t._v("[F,L]")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("Directory")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),e("p",[t._v("If you don't have access to editing Apache Virtual Host you can use a "),e("code",[t._v(".htaccess")]),t._v(" file in the alleged paths:")]),t._v(" "),e("div",{staticClass:"language-apacheconf extra-class"},[e("pre",{pre:!0,attrs:{class:"language-apacheconf"}},[e("code",[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("FilesMatch")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(' "\\.(?'),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v('[Pp][Hh][Pp][345]?|[Pp][Hh][Tt][Mm][Ll])|(po|sql|html?)$"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" !mod_authz_core.c")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Order")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Allow")]),t._v(",Deny\n        "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Deny")]),t._v(" from all\n    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" mod_authz_core.c")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("Require")]),t._v(" all denied\n    "),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("FilesMatch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" mod_php7.c")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    php_flag engine off\n"),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("FilesMatch")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('".+\\.*$"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("SetHandler")]),t._v(" !\n"),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("FilesMatch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token directive-block-parameter attr-value"}},[t._v(" mod_rewrite.c")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive-inline property"}},[t._v("RewriteRule")]),e("span",{pre:!0,attrs:{class:"token regex"}},[t._v(" ^.*\\.php$")]),t._v(" - "),e("span",{pre:!0,attrs:{class:"token directive-flags keyword"}},[t._v("[F,L]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token directive-block tag"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("IfModule")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),e("h3",{attrs:{id:"nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nginx"}},[t._v("#")]),t._v(" NGINX")]),t._v(" "),e("p",[e("code",[t._v("nginx.conf")]),t._v(" for "),e("code",[t._v("server {}")]),t._v(" block:")]),t._v(" "),e("div",{staticClass:"language-nginx extra-class"},[e("pre",{pre:!0,attrs:{class:"language-nginx"}},[e("code",[t._v("    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Disable access to sensitive application files")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ~* (app|content|lib)/.*\\.(po|php|lock|sql)$")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ~* composer\\.json|composer\\.lock|.gitignore$")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ~* /\\.ht")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Image not found replacement")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ~* \\.(jpe?g|png|gif|webp)$")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("log_not_found")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("off")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("error_page")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),t._v(" /content/images/system/default/404.gif")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# CORS header (avoids font rendering issues)")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ~* \\.(ttf|ttc|otf|eot|woff|woff2|font.css|css|js)$")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("add_header")]),t._v(" Access-Control-Allow-Origin "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# PHP front controller")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" /")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("index")]),t._v(" index.php")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try_files")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.php"),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$is_args")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$query_string")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Single PHP-entrypoint (disables direct access to .php files)")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" ~* \\.php$")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("internal")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("include")]),t._v(" snippets/fastcgi-php.conf")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token directive"}},[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fastcgi_pass")]),t._v(" unix:/var/run/php/php7.4-fpm.sock")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"real-connecting-ip"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#real-connecting-ip"}},[t._v("#")]),t._v(" Real connecting IP")]),t._v(" "),e("p",[t._v("For setups under any kind of proxy (including "),e("a",{attrs:{href:"https://support.cloudflare.com/hc/en-us/articles/200170786-Restoring-original-visitor-IPs",target:"_blank",rel:"noopener noreferrer"}},[t._v("CloudFlare"),e("OutboundLink")],1),t._v(") is required that the web server sets the appropriate value for the client connecting IP.")]),t._v(" "),e("div",{staticClass:"custom-block danger"},[e("p",{staticClass:"custom-block-title"},[t._v("DANGER")]),t._v(" "),e("p",[t._v("If real connecting IP is not configured Chevereto won't be able to detect the real visitors IPs, failing to deliver IP based restrictions and flood control.")])]),t._v(" "),e("ul",[e("li",[t._v("NGINX: "),e("code",[t._v("ngx_http_realip_module")])]),t._v(" "),e("li",[t._v("Apache HTTP Server: "),e("code",[t._v("mod_remoteip")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);